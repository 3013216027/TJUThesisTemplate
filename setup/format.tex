% !Mode:: "TeX:UTF-8"
%  Authors: 张井   Jing Zhang: prayever@gmail.com     天津大学2010级管理与经济学部信息管理与信息系统专业硕士生
%           余蓝涛 Lantao Yu: lantaoyu1991@gmail.com  天津大学2008级精密仪器与光电子工程学院测控技术与仪器专业本科生
%  Modified by: 郑冬健 Dongjian Zheng: zhengdongjian2013@gmail.com 天津大学2013级计算机科学与技术专业本科生

%%%%%%%%%%%%%%%%% Fonts Definition and Basics %%%%%%%%%%%%%%%%%
% 字号设置
\newcommand{\yihao}{\fontsize{27.5pt}{27.5pt}\selectfont}           % 一号，单倍行距
\newcommand{\xiaoyi}{\fontsize{24pt}{24pt}\selectfont}              % 小一，单倍行距
\newcommand{\erhao}{\fontsize{21pt}{1.25\baselineskip}\selectfont}  % 二号，1.25倍行距
\newcommand{\xiaoer}{\fontsize{18pt}{18pt}\selectfont}              % 小二，单倍行距
\newcommand{\sanhao}{\fontsize{16pt}{16pt}\selectfont}              % 三号，单倍行距
\newcommand{\xiaosan}{\fontsize{15pt}{15pt}\selectfont}             % 小三，单倍行距
\newcommand{\sihao}{\fontsize{14pt}{14pt}\selectfont}               % 四号，单倍行距
\newcommand{\xiaosi}{\fontsize{12pt}{12pt}\selectfont}              % 小四，单倍行距
\newcommand{\wuhao}{\fontsize{10.5pt}{10.5pt}\selectfont}           % 五号，单倍行距
\newcommand{\xiaowu}{\fontsize{9pt}{9pt}\selectfont}                % 小五，单倍行距
\newcommand{\liuhao}{\fontsize{7.5pt}{7.5pt}\selectfont}            % 六号，单倍行距
% 如果需要添加新的字体定义，使用fc-list( :lang=zh-cn)可列出系统所有(中文)字体及对应名称
\newCJKfontfamily[song]\song{Adobe Song Std}
\newCJKfontfamily[hei]\hei{Adobe Heiti Std}
\newCJKfontfamily[kai]\kai{Adobe Kaiti Std}
% 其它字体定义
\setCJKmainfont{Adobe Song Std}   % 中文衬线，正文主要字体
\setCJKsansfont{Adobe Heiti Std}  % 中文无衬线，影响\sffamily和\textsf
\setCJKmonofont{Adobe Heiti Std}  % 中文等宽，影响\ttfamily和\texttt
\setmainfont{Times New Roman}     % 英文衬线
\setsansfont{Times New Roman}     % 英文无衬线，影响\sffamily和\textsf
\setmonofont{Times New Roman}     % 英文等宽，影响\ttfamily和\texttt

% 间距设置
% \linespread{1}  % 行距
% \setlength{\parskip}{0.4\baselineskip}  % 段间距

% \newcommand{\nocontentsline}[3]{}
% \newcommand{\tocless}[2]{\bgroup\let\addcontentsline=\nocontentsline#1{#2}\egroup}

% 数学操作符
\DeclareMathOperator*{\argmin}{arg\,min} % arg min
\DeclareMathOperator*{\argmax}{arg\,max} % arg max

% 数学公式中常用的宏
\newcommand*{\mean}[1]{\bar{ #1 }}  % 均值
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}  % 范数
\newcommand{\inner}[1]{\langle #1 \rangle}  % 内积
\newcommand{\abs}[1]{\lvert #1 \rvert}  % 绝对值
\newcommand{\distance}[0]{\left\lVert\right.}  % 距离

% 其它宏
\newcommand{\todo}[1]{\textcolor{red}{\{TODO:#1\}}}  % \todo{} 生成红色字体的“TODO: ”，方便编写草稿时打标记。
\newcommand*{\ldash}[0]{\raisebox{0.5mm}{\,-----\,}}  % 破折号

% 算法环境
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
% 调整罗列环境的布局
\setitemize{leftmargin=3em,itemsep=0em,partopsep=0em,parsep=0em,topsep=-0em}
\setenumerate{leftmargin=3em,itemsep=0em,partopsep=0em,parsep=0em,topsep=0em}

% 避免宏包 hyperref 和 arydshln 不兼容带来的目录链接失效的问题。
\def\temp{\relax}
\let\temp\addcontentsline
\gdef\addcontentsline{\phantomsection\temp}

% 自定义项目列表标签及格式 \begin{publist} 列表项 \end{publist}
\newcounter{pubctr} %自定义新计数器
\newenvironment{publist}{%%%%%定义新环境
\begin{list}{[\arabic{pubctr}]} %%标签格式
    {
     \usecounter{pubctr}
     \setlength{\leftmargin}{2.5em}   % 左边界 \leftmargin =\itemindent + \labelwidth + \labelsep
     \setlength{\itemindent}{0em}     % 标号缩进量
     \setlength{\labelsep}{1em}       % 标号和列表项之间的距离,默认0.5em
     \setlength{\rightmargin}{0em}    % 右边界
     \setlength{\topsep}{0ex}         % 列表到上下文的垂直距离
     \setlength{\parsep}{0ex}         % 段落间距
     \setlength{\itemsep}{0ex}        % 标签间距
     \setlength{\listparindent}{0pt}  % 段落缩进量
    }}
{\end{list}}

\makeatletter
\renewcommand\normalsize{
  \@setfontsize\normalsize{12pt}{12pt} % 小四对应 12 pt
  \setlength\abovedisplayskip{4pt}
  \setlength\abovedisplayshortskip{4pt}
  \setlength\belowdisplayskip{\abovedisplayskip}
  \setlength\belowdisplayshortskip{\abovedisplayshortskip}
  \let\@listi\@listI
}

\def\defaultfont{\linespread{1.63}\selectfont} % 设置行距

% \renewcommand{\CJKglue}{\hskip -0.1 pt plus 0.08\baselineskip} % 控制字间距，使每行 34 个汉字
\makeatother


%%%%%%%%%% Chapter and Section %%%%%%%%%%%%%
\setcounter{secnumdepth}{4}
\setlength{\parindent}{2em}
% \titleformat{\section}{\sihao\hei}{\thesection}{1em}{}  % 设置“中文译文”时会覆盖此设置，故section格式移至tjumain.tex中“中文译文后
% \titlespacing{\section}{0pt}{0.15\baselineskip}{0.25\baselineskip}
\titleformat{\subsection}{\sihao\hei}{\thesubsection}{1em}{}
\titlespacing{\subsection}{0pt}{0.1\baselineskip}{0.3\baselineskip}
\titleformat{\subsubsection}{\sihao\hei}{\thesubsubsection}{1em}{}
\titlespacing{\subsubsection}{0pt}{0.05\baselineskip}{0.1\baselineskip}

%%%%%%%%%% Table, Figure and Equation %%%%%%%%%%%%%%%%%
\renewcommand{\tablename}{表}                                     % 插表题头
\renewcommand{\figurename}{图}                                    % 插图题头
\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\thesubfigure}{\alph{subfigure})}                   % 使子图编号为 a) 的格式
\renewcommand{\thesubtable}{(\alph{subtable})}                    % 使子表编号为 (a) 的格式
\renewcommand{\thetable}{\arabic{table}}         % 使表编号为 7-1 的格式
\renewcommand{\theequation}{\arabic{equation}}   % 使公式编号为 7-1 的格式

%%%%%% 定制浮动图形和表格标题样式 %%%%%%
\makeatletter
\long\def\@makecaption#1#2{
   \vskip\abovecaptionskip
   \sbox\@tempboxa{\centering\wuhao\song{#1\qquad #2} }
   \ifdim \wd\@tempboxa >\hsize
     \centering\wuhao\song{#1\qquad #2} \par
   \else
     \global \@minipagefalse
     \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}
   \fi
   \vskip\belowcaptionskip}
\makeatother
\captiondelim{~~~~} %用来控制longtable表头分隔符

%%%%%%%%%% Theorem Environment %%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\theorembodyfont{\song\rmfamily}
\theoremheaderfont{\hei\rmfamily}
\newtheorem{theorem}{定理~}[section]
\newtheorem{lemma}{引理~}[section]
\newtheorem{axiom}{公理~}[section]
\newtheorem{proposition}{命题~}[section]
\newtheorem{prop}{性质~}[section]
\newtheorem{corollary}{推论~}[section]
\newtheorem{definition}{定义~}[section]
\newtheorem{conjecture}{猜想~}[section]
\newtheorem{example}{例~}[section]
\newtheorem{remark}{注~}[section]
%\newtheorem{algorithm}{算法~}[section]
\newenvironment{proof}{\noindent{\hei 证明：}}{\hfill $ \square $ \vskip 4mm}
\theoremsymbol{$\square$}

%%%%%%%%%% Page: number, header and footer  %%%%%%%%%%%%%%%%%

%\frontmatter 或 \pagenumbering{roman}
%\mainmatter 或 \pagenumbering{arabic}

%%%%%%%%%%%% References %%%%%%%%%%%%%%%%%
\renewcommand{\bibname}{参考文献}
% 重定义参考文献样式，来自thu
\makeatletter
\renewenvironment{thebibliography}[1]{
    \titleformat{\section}{\raggedright\sihao\hei}{\sectionname}{2em}{}
   \section*{\bibname}
   \wuhao
   \list{\@biblabel{\@arabic\c@enumiv}}
        {\renewcommand{\makelabel}[1]{##1\hfill}
         \settowidth\labelwidth{0 cm}
         \setlength{\labelsep}{0pt}
         \setlength{\itemindent}{0pt}
         \setlength{\leftmargin}{\labelwidth+\labelsep}
         \addtolength{\itemsep}{-0.7em}
         \usecounter{enumiv}
         \let\p@enumiv\@empty
         \renewcommand\theenumiv{\@arabic\c@enumiv}}
    \sloppy\frenchspacing
    \clubpenalty4000
    \@clubpenalty \clubpenalty
    \widowpenalty4000
    \interlinepenalty4000
    \sfcode`\.\@m}
   {\def\@noitemerr
     {\@latex@warning{Empty `thebibliography' environment}}
    \endlist\frenchspacing}
\makeatother

\addtolength{\bibsep}{-0.5em}     % 缩小参考文献间的垂直间距
\setlength{\bibhang}{2em}         % 每个条目自第二行起缩进的距离

% 参考文献引用作为上标出现
%\newcommand{\citeup}[1]{\textsuperscript{\cite{#1}}}
\makeatletter
    \def\@cite#1#2{\textsuperscript{[{#1\if@tempswa , #2\fi}]}}
\makeatother
%% 引用格式
\bibpunct{[}{]}{,}{s}{}{,}

%%%%%%%%%%%% Cover %%%%%%%%%%%%%%%%%
% 封面、摘要、版权、致谢格式定义
\makeatletter
\def\ctitle#1{\def\@ctitle{#1}}\def\@ctitle{}
\def\cdegree#1{\def\@cdegree{#1}}\def\@cdegree{}
\def\caffil#1{\def\@caffil{#1}}\def\@caffil{}
\def\csubject#1{\def\@csubject{#1}}\def\@csubject{}
\def\cgrade#1{\def\@cgrade{#1}}\def\@cgrade{}
\def\cauthor#1{\def\@cauthor{#1}}\def\@cauthor{}
\def\cnumber#1{\def\@cnumber{#1}}\def\@cnumber{}
\def\csupervisor#1{\def\@csupervisor{#1}}\def\@csupervisor{}
\def\crank#1{\def\@crank{#1}}\def\@crank{}
\def\cdate#1{\def\@cdate{#1}}\def\@cdate{}
\long\def\cabstract#1{\long\def\@cabstract{#1}}\long\def\@cabstract{}
% \long\def\eabstract#1{\long\def\@eabstract{#1}}\long\def\@eabstract{}
% \def\ckeywords#1{\def\@ckeywords{#1}}\def\@ckeywords{}
% \def\ekeywords#1{\def\@ekeywords{#1}}\def\@ekeywords{}
\def\cheading#1{\def\@cheading{#1}}\def\@cheading{}

\pagestyle{empty}
%   \fancyhf{}
%   \fancyhead[C]{\song\wuhao \@cheading}  % 页眉显示天津大学 20XX 届本科生毕业论文
%   \fancyfoot[C]{\song\xiaowu ~\thepage~}
% \newlength{\@title@width}

% 定义封面
\def\makecover{
%%%%%%%%%%%%%%%%%%%   Abstract and Keywords  %%%%%%%%%%%%%%%%%%%%%%%
\markboth{摘~要}{摘~要}
\pdfbookmark[0]{摘~~要}{cabstract}
%\addcontentsline{toc}{section}{摘~要}
\section*{\centering\sanhao\hei\bfseries 摘\qquad 要}
\song\defaultfont
\@cabstract
\vspace{\baselineskip}

\hangafter=1\hangindent=52.3pt\noindent
% {\hei\xiaosi 关键词：} \@ckeywords
% \thispagestyle{empty}
}
\makeatother
